import{r as a,j as e,a as k}from"./app-DHwXSQtM.js";import{A as y}from"./AppLayout-BhLdE5X6.js";import{F as _,a as C}from"./CurrencyDollarIcon-ChRmwJQu.js";function R({title:s,titleId:l,...c},i){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":l},c),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const E=a.forwardRef(R);function L({title:s,titleId:l,...c},i){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":l},c),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const M=a.forwardRef(L);function A({title:s,titleId:l,...c},i){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":l},c),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const F=a.forwardRef(A);function P({title:s,titleId:l,...c},i){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":l},c),s?a.createElement("title",{id:l},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const S=a.forwardRef(P);function W(){const[s,l]=a.useState(null),[c,i]=a.useState(!0),[r,u]=a.useState(1),[x]=a.useState(10),[o,j]=a.useState({start_date:"",end_date:"",seller_id:""});a.useEffect(()=>{p()},[]);const p=async()=>{i(!0);try{const t=new URLSearchParams;o.start_date&&t.append("start_date",o.start_date),o.end_date&&t.append("end_date",o.end_date),o.seller_id&&t.append("seller_id",o.seller_id);const n=await(await fetch(`/reports/sales?${t.toString()}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}})).json();l(n)}catch(t){console.error("Error fetching sales report:",t)}finally{i(!1)}},h=t=>Math.round(t||0).toLocaleString()+" دينار",g=(t,d)=>{j(n=>({...n,[t]:d}))},w=()=>{u(1),p()},v=()=>{if(!s?.sales)return[];const t=(r-1)*x,d=t+x;return s.sales.slice(t,d)},m=s?.sales?Math.ceil(s.sales.length/x):0,N=t=>{u(t)},f=()=>{r>1&&u(r-1)},b=()=>{r<m&&u(r+1)};return c?e.jsx(y,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"جاري تحميل تقرير المبيعات..."})]})})}):e.jsx(y,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsxs("button",{onClick:()=>k.visit("/reports"),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(E,{className:"w-5 h-5 ml-2"}),"العودة للتقارير"]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"تقرير المبيعات"}),e.jsx("p",{className:"text-gray-600",children:"تحليل مفصل لجميع عمليات البيع والأرباح"})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"تصفية التقرير"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"من تاريخ"}),e.jsx("input",{type:"date",value:o.start_date,onChange:t=>g("start_date",t.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"إلى تاريخ"}),e.jsx("input",{type:"date",value:o.end_date,onChange:t=>g("end_date",t.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البائع"}),e.jsxs("select",{value:o.seller_id,onChange:t=>g("seller_id",t.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"جميع البائعين"}),s?.sellers?.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:w,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"تطبيق التصفية"})})]})]}),s?.summary&&e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"إجمالي المبيعات"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h(s.summary.total_revenue)})]}),e.jsx(_,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"صافي الربح"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h(s.summary.total_profit)})]}),e.jsx(C,{className:"w-8 h-8 text-emerald-500"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"عدد العمليات"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.summary.count})]}),e.jsx(F,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"متوسط البيع"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h(s.summary.average_sale)})]}),e.jsx(M,{className:"w-8 h-8 text-purple-500"})]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"تفاصيل المبيعات"})}),e.jsx("div",{className:"overflow-x-auto",children:s?.sales&&s.sales.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التاريخ"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المنتج"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"البائع"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكمية"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"إجمالي المبيعات"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الربح"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نوع الدفع"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v().map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(t.created_at).toLocaleDateString("ar-IQ")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.product_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.seller_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.quantity_sold}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h(t.total_revenue)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h(t.total_profit)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.payment_type==="cash"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.payment_type==="cash"?"نقدي":"أجل"})})]},d))})]}),m>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:f,disabled:r===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"السابق"}),e.jsx("button",{onClick:b,disabled:r===m,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"التالي"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["عرض"," ",e.jsx("span",{className:"font-medium",children:(r-1)*x+1})," ","إلى"," ",e.jsx("span",{className:"font-medium",children:Math.min(r*x,s.sales.length)})," ","من"," ",e.jsx("span",{className:"font-medium",children:s.sales.length})," ","نتيجة"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:f,disabled:r===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"السابق"}),Array.from({length:Math.min(5,m)},(t,d)=>{let n;return m<=5||r<=3?n=d+1:r>=m-2?n=m-4+d:n=r-2+d,e.jsx("button",{onClick:()=>N(n),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${r===n?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:n},n)}),e.jsx("button",{onClick:b,disabled:r===m,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"التالي"})]})})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"لا توجد مبيعات"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"لم يتم العثور على مبيعات في الفترة المحددة"})]})})]})]})})}export{W as default};
