import{r as y,u as f,j as e,H as j,L as b}from"./app-BMOinr9P.js";import{A as p}from"./AppLayout-Dj36bdM3.js";function k({debt:r,payments:i}){const[x,s]=y.useState(!1),{data:n,setData:l,post:m,processing:o,errors:d,reset:c}=f({amount:"",notes:""}),a=t=>new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0}).format(t),g=t=>{t.preventDefault(),m(`/debts/${r.id}/payment`,{onSuccess:()=>{c(),s(!1)}})},h=t=>t>0?"text-red-600 bg-red-50":"text-green-600 bg-green-50",u=t=>t>0?"مستحق":"مدفوع بالكامل";return e.jsxs(p,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200",children:["تفاصيل الدين - ",r.customer_name]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["رقم الدين: #",r.id]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{href:"/debts",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"العودة للقائمة"}),r.remaining_amount>0&&e.jsx("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"إضافة دفعة"})]})]}),children:[e.jsx(j,{title:`تفاصيل الدين - ${r.customer_name}`}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-lg rounded-lg border border-gray-200 dark:border-gray-700 mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"اسم العميل"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:r.customer_name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"المبلغ الأصلي"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a(r.total_amount)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"المبلغ المدفوع"}),e.jsx("div",{className:"text-lg font-semibold text-green-600",children:a(r.paid_amount)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"المبلغ المتبقي"}),e.jsx("div",{className:"text-lg font-semibold text-red-600",children:a(r.remaining_amount)})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${h(r.remaining_amount)}`,children:u(r.remaining_amount)}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["تاريخ الدين: ",new Date(r.created_at).toLocaleDateString("ar-EG")]})]}),r.remaining_amount>0&&e.jsxs("div",{className:"w-full max-w-xs",children:[e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:["نسبة السداد: ",(r.paid_amount/r.total_amount*100).toFixed(1),"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${r.paid_amount/r.total_amount*100}%`}})})]})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-lg rounded-lg border border-gray-200 dark:border-gray-700 mb-6",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"تفاصيل البيع"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"المنتج"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:r.sale.product.name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:r.sale.product.description})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"الكمية"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[r.sale.quantity," قطعة"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"سعر الوحدة"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a(r.sale.unit_price)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"تاريخ البيع"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:new Date(r.sale.created_at).toLocaleDateString("ar-EG")})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-lg rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"سجل الدفعات"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"المبلغ"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"الملاحظات"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"التاريخ"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("p",{className:"mt-2 text-sm",children:"لا توجد دفعات حتى الآن"})]})})}):i.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:a(t.amount)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:t.notes||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString("ar-EG")})]},t.id))})]})})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"إضافة دفعة جديدة"}),e.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["المبلغ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"amount",step:"0.01",min:"0.01",max:r.remaining_amount,value:n.amount,onChange:t=>l("amount",t.target.value),placeholder:"0.00",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0}),d.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.amount}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["الحد الأقصى: ",a(r.remaining_amount)]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"ملاحظات"}),e.jsx("textarea",{id:"notes",rows:3,value:n.notes,onChange:t=>l("notes",t.target.value),placeholder:"ملاحظات اختيارية...",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),d.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.notes})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50",children:o?"جاري الحفظ...":"إضافة الدفعة"})]})]})]})})})]})}export{k as default};
